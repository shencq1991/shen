import pandas as pd
import numpy as np 
import os
import xlrd
import tushare as ts
import pandas as pd
from sqlalchemy import create_engine
import datetime

# df=ts.get_report_data(2017,3)
# codes=list(set(df.loc[:,'code']))
# print(codes)
# df_nk=pd.DataFrame()
# list_k=[]
# for code in codes:
# 	list_k.append(code)
# df_nk=pd.DataFrame({'code':str(list_k),
# 						'name':['代码']
# 						})
# df_nk.to_excel('E:\\blog数据\\代码.xlsx',encoding='utf-8')

list_code=['300357', '002887', '002847', '603337', '002718', '000404', '300508', '002231', '600207', '600936', '002361', '002595', '600255', '002306', '300341', '002133', '002850', '300114', '603586', '603855', '600866', '300654', '600250', '000632', '300453', '002825', '603128', '000090', '603300', '002524', '600490', '000619', '600986', '002910', '300023', '300219', '600436', '300491', '002905', '600897', '300406', '603197', '600206', '000530', '002385', '002864', '300421', '300380', '300484', '000825', '600863', '002743', '600565', '002614', '600765', '603801', '002497', '603929', '600495', '002132', '002460', '601788', '000779', '300339', '002018', '603028', '300158', '603076', '600658', '002839', '601811', '300351', '002658', '300722', '603660', '603110', '300013', '300194', '600449', '600509', '600841', '601313', '300532', '300419', '002773', '603303', '601288', '002686', '300215', '002255', '001696', '002193', '600063', '000573', '002742', '000760', '600291', '002390', '002221', '300155', '300245', '002820', '002028', '002408', '603166', '000524', '300063', '002592', '600112', '300225', '603579', '000062', '600030', '603387', '002445', '002164', '600467', '603986', '300207', '603031', '603669', '600690', '002470', '002552', '600682', '600877', '002474', '000034', '600270', '000088', '603906', '000025', '000693', '600796', '002617', '002719', '603501', '600803', '300232', '000531', '000301', '603958', '002401', '000725', '603939', '600939', '600540', '002444', '000403', '002163', '300677', '002025', '600759', '002073', '300360', '600251', '000998', '600681', '601636', '300703', '600801', '300122', '002056', '002682', '002703', '603803', '002868', '603042', '002918', '002275', '603183', '002012', '600359', '600592', '300580', '000430', '300211', '002411', '002631', '600320', '002654', '300104', '600157', '600701', '600582', '600019', '300228', '600220', '603421', '300304', '600590', '603018', '002903', '002680', '000018', '000068', '002040', '601218', '603997', '603996', '600370', '000797', '002766', '600337', '002192', '002728', '000597', '603258', '603313', '002727', '600426', '603289', '002799', '300270', '002657', '603716', '600969', '002234', '600798', '002104', '002154', '000606', '600510', '002724', '300659', '300346', '002354', '002165', '002835', '300572', '603355', '603101', '002681', '600353', '600748', '300648', '000811', '000799', '000800', '603416', '000826', '000559', '000715', '000550', '002752', '002024', '600093', '002829', '300657', '600826', '002241', '600723', '002485', '601872', '603020', '000536', '000960', '600126', '600512', '600674', '000408', '000418', '000767', '603466', '002879', '603711', '603699', '600903', '601949', '300685', '002395', '000600', '600178', '002462', '002781', '600683', '300451', '600635', '300350', '002216', '603538', '000927', '002222', '600470', '300011', '000596', '000788', '603117', '002713', '600031', '000996', '000703', '002601', '000883', '300154', '002545', '600833', '300302', '600737', '300017', '002209', '000761', '002788', '600962', '300441', '002070', '300539', '002403', '002047', '601677', '002206', '300259', '600537', '600299', '002356', '600697', '300188', '002424', '300696', '002433', '603528', '002435', '603077', '300092', '000913', '000948', '000671', '002750', '600463', '300342', '601225', '002531', '300200', '000976', '300086', '300214', '300566', '600305', '601069', '600319', '600926', '300275', '600071', '300167', '002210', '002448', '600692', '603180', '300062', '300075', '002863', '600448', '603568', '002130', '603920', '600318', '603277', '600234', '600336', '002872', '000780', '300557', '300579', '600753', '300226', '600223', '002172', '000848', '002838', '600107', '002662', '300627', '600211', '002026', '600221', '600615', '002797', '600828', '603456', '002272', '002456', '300298', '300727', '601588', '300390', '300723', '600792', '603663', '000818', '002365', '002440', '002258', '002605', '300322', '300116', '002202', '600884', '603588', '002029', '601168', '002796', '300583', '300731', '300437', '603639', '300045', '000876', '600561', '300618', '600967', '300385', '002846', '600848', '300708', '002102', '600072', '002623', '600119', '603398', '600477', '600217', '600825', '002297', '000419', '601366', '002350', '603186', '000426', '000552', '000538', '601566', '002391', '600070', '300172', '603819', '603977', '600770', '000010', '300320', '603319', '603198', '300301', '002473', '600511', '300087', '002186', '300465', '002267', '300137', '600995', '002659', '600757', '000922', '600746', '300212', '300048', '600230', '000807', '300716', '603980', '002726', '601919', '600734', '600822', '002072', '601928', '300076', '603707', '603323', '002415', '300601', '000567', '603838', '300006', '002061', '002033', '000729', '603883', '002236', '300552', '002287', '603396', '002562', '300216', '002150', '002443', '002320', '603386', '002759', '601333', '002430', '002387', '002599', '002286', '002520', '600513', '600115', '300630', '000009', '300607', '300297', '600742', '000863', '600808', '000836', '002538', '002899', '601689', '002259', '600084', '600479', '600859', '000669', '002670', '002376', '600506', '002250', '600596', '603225', '000962', '600160', '002791', '300241', '600106', '600313', '002291', '300176', '002105', '000661', '601800', '002436', '601996', '002857', '300555', '000005', '002001', '600288', '002644', '600572', '002227', '603599', '600321', '002749', '300124', '002882', '300323', '300290', '000413', '603890', '300715', '002496', '300299', '600810', '603758', '603309', '002276', '600379', '002080', '300100', '300117', '600979', '000707', '603326', '601877', '600060', '000006', '600971', '000029', '600600', '002643', '600327', '300675', '600570', '603861', '000758', '600340', '300240', '002068', '000968', '300538', '000637', '002003', '300623', '600958', '600660', '600567', '300393', '002199', '002268', '002393', '002532', '002372', '300153', '300581', '000622', '600761', '600867', '300166', '002171', '600793', '600755', '601991', '002840', '300192', '600322', '300405', '002090', '000019', '002789', '002021', '601005', '002695', '600875', '600645', '600136', '300144', '002818', '600408', '600419', '300001', '600499', '000626', '600858', '603181', '300533', '300127', '300148', '002917', '000532', '300164', '600633', '000751', '601179', '002089', '600551', '000766', '002423', '603001', '300161', '600435', '002346', '600844', '000028', '300584', '002369', '002203', '002017', '002085', '601018', '002698', '601117', '002323', '600487', '002492', '002119', '002679', '300527', '603602', '300690', '600433', '603808', '002600', '300236', '002188', '601336', '603019', '600343', '600505', '002663', '600163', '002120', '002011', '601988', '600992', '002421', '300387', '300712', '600130', '603603', '600350', '002911', '002541', '601137', '002035', '600162', '000902', '600550', '000159', '300295', '002715', '300328', '300094', '300071', '600981', '600673', '601918', '300335', '300258', '603088', '603963', '002228', '600665', '603648', '300149', '002808', '000950', '601028', '600891', '002184', '002308', '002483', '603936', '600213', '600361', '002351', '600469', '002381', '600549', '002506', '000717', '300620', '600080', '300272', '002170', '603000', '300638', '300479', '601515', '002111', '603881', '600215', '002289', '600425', '000416', '601518', '002915', '600717', '002465', '002173', '002589', '002867', '600038', '002669', '600687', '002716', '600239', '600232', '600392', '600843', '603839', '300726', '300336', '300665', '600489', '002488', '600857', '000400', '300635', '300309', '601881', '300510', '000716', '300147', '600366', '002776', '002331', '603126', '300707', '600352', '002523', '002449', '603165', '600083', '603133', '600172', '000791', '002097', '300713', '300128', '000667', '002273', '002251', '300430', '300649', '603008', '002357', '600219', '603011', '600329', '603976', '000967', '002651', '001896', '603090', '601015', '000983', '603040', '002869', '000932', '002189', '300637', '300064', '002841', '002113', '000598', '300586', '002382', '300377', '603496', '002032', '300280', '002050', '000620', '300415', '002263', '300180', '600149', '002158', '000631', '000709', '300053', '300018', '000972', '300201', '002179', '000952', '300611', '300443', '603555', '600735', '002030', '300037', '002211', '300110', '600121', '300029', '600161', '603768', '600201', '002748', '000035', '002096', '603017', '002821', '002779', '600351', '603661', '002866', '600970', '600496', '300622', '002178', '002248', '002335', '601012', '002416', '603032', '603444', '300330', '000401', '300238', '002837', '000868', '300080', '603500', '300680', '300547', '600881', '000521', '002880', '300424', '601985', '603776', '002374', '002468', '002232', '002812', '300274', '000615', '300647', '603887', '002650', '603991', '300442', '002476', '600719', '601766', '600409', '300345', '600111', '300495', '600315', '002230', '600789', '600287', '002884', '300019', '002624', '600335', '300287', '000885', '000510', '601166', '300024', '300632', '600176', '601668', '600000', '000022', '600616', '300121', '600531', '600323', '300208', '600529', '002062', '603638', '300418', '002722', '002475', '300497', '600527', '002587', '603196', '600131', '000012', '002707', '000628', '300639', '300545', '601611', '601128', '300423', '601717', '002207', '002302', '600196', '603767', '300595', '300656', '300204', '603806', '600416', '002694', '000506', '002518', '600679', '601555', '300517', '300440', '002559', '002438', '600996', '603369', '000026', '300229', '603856', '000032', '600308', '300221', '002613', '600328', '600530', '603029', '600885', '300709', '002489', '002384', '300502', '002733', '600418', '002076', '300081', '600028', '600827', '600145', '600103', '002855', '000953', '002598', '300718', '600090', '000710', '300428', '300475', '002160', '600727', '000503', '603569', '002095', '300383', '601368', '300565', '002477', '002243', '600190', '603656', '002345', '300242', '002609', '300332', '300183', '000726', '603233', '300526', '600401', '000423', '000027', '603458', '300683', '002661', '002431', '000613', '300131', '002729', '000925', '601616', '000507', '002828', '600302', '603683', '603123', '002220', '300729', '002792', '603999', '002751', '000673', '002758', '603987', '002566', '002549', '603127', '601222', '002762', '600333', '000688', '002045', '600917', '002204', '300257', '002434', '002450', '300012', '600197', '002086', '300477', '603811', '601901', '002607', '002071', '002550', '600816', '603113', '002568', '603608', '300730', '600240', '002067', '600098', '002875', '300721', '600628', '603357', '000700', '600269', '600420', '600152', '300239', '300234', '603099', '000892', '600191', '000978', '002817', '002827', '601238', '600202', '600166', '000020', '002406', '600804', '300695', '603507', '300549', '600728', '600059', '603685', '603676', '000702', '600226', '000591', '600823', '603659', '300146', '002522', '600200', '300490', '300732', '600873', '300578', '300603', '000156', '300159', '300015', '300427', '600371', '002611', '000679', '300487', '002371', '300592', '002690', '002495', '300026', '300052', '300448', '002810', '600386', '002514', '000937', '002008', '300103', '300133', '600850', '000961', '002036', '300550', '603668', '600754', '300543', '300190', '002141', '600768', '600650', '002159', '002023', '600571', '300616', '300615', '300525', '300493', '002074', '002591', '600446', '603823', '000561', '002295', '603069', '300030', '600888', '002618', '002260', '603358', '300263', '603598', '000909', '600893', '300251', '603002', '002765', '002806', '600348', '000672', '300655', '000785', '002790', '600312', '002590', '002696', '002117', '000157', '000151', '600525', '300688', '000555', '002706', '600642', '002491', '000875', '002213', '002265', '300151', '300284', '600068', '002688', '000655', '300293', '300512', '601958', '000014', '600295', '603322', '002737', '002757', '002909', '002570', '600122', '002190', '002083', '300108', '600973', '600393', '300316', '600880', '300286', '000963', '600919', '600811', '600869', '000099', '300488', '600722', '002088', '300403', '002503', '603766', '002392', '603269', '603778', '000806', '300587', '600845', '002368', '601038', '600421', '603260', '600898', '600395', '000823', '300069', '000511', '300725', '600980', '600581', '300400', '600604', '300235', '002819', '603311', '600736', '002139', '000566', '002269', '002305', '603527', '002519', '603533', '002389', '601318', '600618', '300248', '600257', '600783', '300070', '002349', '002337', '601699', '300253', '601163', '603833', '002574', '600851', '300181', '000686', '601666', '600488', '002420', '603843', '002674', '603393', '600456', '000822', '002418', '300209', '001979', '000939', '300250', '601799', '002013', '000878', '603315', '601198', '002341', '002577', '600990', '000625', '002218', '300558', '603978', '002238', '601866', '600594', '300546', '000541', '002194', '603860', '603012', '300589', '000333', '600794', '600369', '300667', '603566', '002641', '600362', '300362', '600218', '600338', '300324', '000768', '603618', '000519', '000862', '603515', '002352', '600037', '300095', '000850', '300132', '603628', '000901', '300319', '300185', '600062', '002499', '300571', '002108', '002110', '300513', '300478', '300613', '300522', '600300', '000420', '603519', '600743', '300536', '002398', '300252', '600739', '000592', '002573', '000852', '600750', '002785', '600785', '000831', '002383', '002149', '002640', '601101', '600439', '300590', '002037', '600100', '300470', '603286', '300553', '000518', '002536', '600838', '300609', '600406', '000528', '600339', '600741', '002652', '601966', '000919', '002666', '002745', '300268', '002432', '300407', '000543', '600547', '601326', '000929', '002527', '300402', '603558', '002386', '002597', '002277', '603727', '002843', '603937', '002560', '603901', '000422', '600011', '300310', '300561', '603363', '300473', '600258', '603959', '300047', '002183', '601088', '300474', '002140', '600132', '002461', '600139', '002399', '002649', '002233', '002780', '002201', '002223', '002731', '300057', '000903', '000548', '000899', '300353', '603518', '603335', '002161', '603797', '600306', '002379', '000509', '601000', '000402', '002363', '002558', '600307', '600708', '603009', '603798', '603679', '603168', '300261', '002301', '300318', '000955', '600688', '300499', '603993', '000501', '000096', '300195', '300559', '600455', '600076', '000737', '600097', '600355', '600303', '000815', '300519', '002125', '002567', '002325', '002664', '300399', '600165', '603912', '600280', '300711', '002895', '002509', '300410', '603903', '600641', '000722', '300395', '300279', '601688', '002152', '002676', '600459', '000821', '600292', '300631', '603988', '600012', '300355', '603058', '600644', '600432', '600523', '300452', '600865', '600647', '603689', '300300', '002873', '000949', '300530', '603729', '600238', '000582', '600317', '002016', '600599', '300700', '300599', '300105', '000739', '002529', '603665', '002457', '300482', '603979', '601579', '600751', '002741', '603138', '002612', '603818', '300445', '000570', '300034', '600508', '002897', '300002', '002225', '002293', '002581', '002697', '000599', '002556', '600896', '603858', '600485', '002380', '000571', '600066', '002734', '002055', '300412', '600123', '000828', '300288', '300089', '600715', '601899', '300143', '600556', '000993', '601818', '600108', '600640', '002168', '601186', '300472', '603989', '601006', '002359', '000887', '600711', '603499', '603208', '601020', '002322', '600429', '600809', '600705', '600050', '300135', '300213', '601601', '603966', '002342', '300277', '300368', '300142', '603698', '601016', '300433', '600298', '600225', '600193', '000786', '600346', '000635', '000049', '603726', '002620', '600559', '002907', '600545', '002738', '000796', '000048', '000915', '002668', '002237', '600983', '002771', '002147', '002034', '000526', '300717', '000665', '603179', '002285', '600806', '600271', '603866', '002569', '000410', '600186', '002066', '000560', '300434', '600689', '603926', '603859', '002526', '002180', '300515', '002324', '300570', '300582', '300008', '600965', '603899', '600546', '603060', '600758', '002007', '600653', '600528', '000411', '002020', '600367', '603879', '601001', '601169', '002625', '002693', '002155', '300507', '002144', '300184', '601019', '002606', '002347', '600053', '601200', '300291', '300247', '002145', '300438', '000078', '002185', '600444', '603098', '600476', '600883', '600064', '300199', '600589', '601208', '000038', '000900', '300129', '603308', '601700', '002138', '600933', '300218', '002051', '600966', '300296', '603922', '600208', '600169', '002282', '300516', '601619', '600829', '000720', '600787', '000158', '600058', '002892', '000721', '600603', '601098', '600155', '002200', '600868', '601021', '600724', '600377', '600702', '601155', '002890', '300391', '000880', '002084', '002135', '300102', '300119', '002052', '000877', '000023', '600790', '002419', '002557', '000533', '000504', '002845', '600235', '000639', '600624', '002777', '002116', '600029', '603321', '300079', '300408', '603636', '601108', '002510', '600605', '300058', '600182', '601858', '300548', '000630', '300568', '600073', '000979', '600268', '600460', '600767', '600242', '000544', '600575', '601633', '603022', '002404', '600704', '002014', '600853', '002642', '300485', '002217', '002409', '300500', '002699', '002712', '000756', '600648', '002400', '002058', '002783', '000830', '300417', '300294', '002803', '000975', '300175', '002175', '600718', '300446', '300065', '002373', '600067', '300197', '603578', '002181', '300173', '000059', '600636', '300327', '600423', '000557', '600774', '600745', '000727', '603169', '002637', '601882', '300088', '002860', '000711', '002137', '300333', '603703', '600290', '300352', '002632', '601388', '000810', '600275', '603909', '300496', '300130', '002122', '601010', '002224', '002413', '600685', '002466', '002579', '300344', '000759', '000928', '000514', '300125', '300068', '603536', '300401', '300528', '000921', '600760', '601231', '300198', '002730', '603129', '300698', '600380', '300139', '300321', '601377', '600493', '300051', '603003', '600478', '002177', '600256', '300481', '002484', '603041', '000633', '000691', '601669', '603368', '300651', '002044', '000997', '300666', '000987', '002604', '600729', '000670', '600643', '300260', '002482', '603789', '300061', '600780', '600389', '000547', '300461', '300503', '600864', '603103', '601398', '000695', '002813', '000793', '300364', '000681', '300692', '603025', '600563', '603199', '000851', '603066', '600821', '002002', '600069', '603388', '603829', '600987', '600815', '002576', '600988', '002075', '000002', '002805', '002049', '002858', '600775', '002627', '002358', '300567', '002900', '002292', '002685', '600273', '300371', '002452', '600330', '000585', '600010', '002128', '300687', '002902', '002093', '000593', '300662', '600836', '300347', '603239', '000835', '002646', '603232', '601009', '000895', '002099', '600695', '600146', '600797', '002537', '002123', '002534', '002916', '600568', '000488', '300720', '002770', '002772', '600216', '000638', '300540', '300537', '002253', '600277', '600117', '000040', '000042', '002675', '002755', '000969', '600188', '000046', '300480', '300449', '600909', '600976', '300650', '603227', '600004', '000651', '300600', '603037', '300082', '300179', '300404', '300457', '600871', '603609', '600422', '002107', '600189', '002709', '300563', '002064', '600079', '002077', '601992', '000498', '002626', '002162', '002321', '603690', '600143', '600639', '600491', '002326', '600116', '603535', '603229', '002009', '603928', '603136', '600128', '002053', '603918', '002687', '600383', '000537', '603188', '002564', '002377', '002673', '600637', '000595', '002876', '300389', '000663', '600876', '600595', '603222', '603667', '002575', '600982', '600664', '603365', '000859', '600056', '000576', '600707', '000990', '600892', '002585', '600170', '600738', '002109', '603637', '002214', '600388', '600519', '600260', '300246', '002521', '002437', '000517', '002878', '000008', '603015', '002775', '300027', '002313', '600091', '300269', '300494', '300112', '601599', '000061', '600686', '300367', '002405', '002530', '000959', '603559', '603078', '002678', '300626', '002039', '603085', '002886', '601968', '000708', '300534', '600075', '600613', '603617', '002336', '603607', '002100', '600261', '300604', '300066', '002665', '603177', '600749', '603005', '603021', '002721', '603917', '300091', '300463', '600452', '600113', '300115', '002893', '000856', '002407', '002528', '600486', '002031', '600375', '600691', '300376', '600733', '002311', '300689', '300078', '002667', '002429', '000050', '002603', '002836', '002124', '603898', '600580', '600684', '002441', '000589', '300254', '600017', '300365', '002645', '600008', '300386', '603083', '000031', '002063', '600151', '600022', '600539', '600649', '603889', '603477', '300182', '000889', '300084', '300422', '600018', '002898', '300455', '600088', '600289', '603616', '300237', '600516', '600961', '600309', '600078', '002242', '300227', '600399', '603619', '600586', '600560', '300326', '002219', '000936', '603339', '002533', '002832', '600593', '002187', '300056', '002824', '002823', '002746', '600610', '300653', '600713', '300514', '000893', '600081', '300511', '300535', '603035', '300682', '000428', '002498', '603916', '601789', '603998', '002901', '600248', '000676', '601900', '002714', '300606', '300560', '601188', '002544', '300244', '300325', '603278', '600175', '300003', '603605', '601011', '600148', '601718', '000584', '002763', '603226', '000981', '300109', '002547', '002629', '002472', '000551', '600533', '300681', '002366', '600608', '603585', '300230', '002425', '000813', '600835', '000923', '300118', '600587', '002543', '600398', '601139', '000910', '603389', '000678', '601008', '600500', '002896', '002060', '600105', '603359', '300366', '000728', '600033', '000757', '000155', '603488', '603306', '600231', '603158', '603885', '600908', '002586', '002634', '000690', '600415', '600137', '002439', '002328', '600720', '300414', '601086', '601106', '600676', '002281', '300541', '603817', '600861', '002442', '300505', '000616', '002639', '603722', '600802', '600285', '000636', '000065', '601107', '000650', '300220', '002572', '000731', '000659', '601519', '300313', '600588', '002240', '600678', '600397', '600784', '300577', '002091', '002338', '002513', '601600', '000611', '300285', '300073', '601007', '000938', '600241', '600015', '300314', '300369', '603159', '600267', '300038', '300398', '600356', '603970', '002304', '603630', '300459', '002908', '002339', '600282', '300099', '002208', '300633', '002767', '000058', '000985', '600502', '002271', '600634', '603718', '002167', '603601', '300307', '002768', '002396', '002822', '603081', '600023', '601500', '002312', '300676', '002467', '002195', '000803', '000897', '300267', '300370', '600583', '300096', '002048', '002015', '600532', '300040', '002453', '600779', '300636', '002355', '000973', '603633', '603567', '601216', '002561', '300174', '300140', '000502', '300719', '002683', '601952', '002106', '300054', '600403', '603869', '600882', '002830', '002515', '600963', '000809', '002422', '300621', '002136', '300334', '000861', '300035', '600555', '300573', '002069', '603969', '600203', '600199', '002092', '600293', '600536', '002247', '600156', '000802', '000608', '600501', '300282', '002502', '002816', '300210', '600621', '600847', '002343', '000833', '603825', '000837', '601233', '300483', '002881', '603809', '603331', '600368', '300126', '002065', '000060', '002294', '600579', '603043', '600410', '000066', '300426', '300223', '300378', '603955', '600818', '002299', '600807', '000713', '300271', '002334', '600675', '002913', '601375', '600138', '002469', '000037', '600212', '601888', '002270', '600376', '600886', '000777', '600668', '600626', '000926', '600652', '002252', '600666', '002353', '603027', '603708', '603615', '300521', '002677', '300661', '002593', '600246', '002671', '000540', '300315', '300432', '002494', '002174', '600620', '300356', '603023', '002360', '000917', '600824', '600082', '601002', '000965', '601390', '300134', '600548', '600301', '002451', '000652', '000735', '002493', '300256', '002329', '600619', '601999', '002246', '603050', '000931', '600975', '002807', '300363', '002479', '600978', '600094', '300039', '600856', '002094', '000966', '300673', '603737', '002112', '600526', '000980', '002861', '600606', '601100', '002504', '300243', '600694', '600358', '002786', '002507', '002735', '002317', '000685', '600153', '000858', '600623', '300663', '300641', '002370', '600158', '603038', '002333', '600598', '300156', '000718', '600310', '300266', '601965', '300020', '600276', '002344', '000905', '002490', '603826', '600372', '600247', '600331', '002340', '601608', '002578', '603089', '002148', '000100', '600855', '600252', '002296', '300439', '603063', '603730', '000662', '600894', '002842', '300046', '000762', '002565', '000752', '300597', '600171']


df=pd.DataFrame()
t=1
for item in list_code:
	for i in range(2015,2018):
		for j in range(0,4):
			df_n=pd.DataFrame()
			start_time = datetime.date(i,1+j*3,1)
			end_time = start_time+datetime.timedelta(days=89)
			df_x=ts.get_hist_data(item,start=str(start_time),end=str(end_time))
			a=df_x.loc[:,'close']
			v=df_x.loc[:,'volume']

			try:
				price=np.average(a,weights=v)
			except:
				price="-"

			df_n=pd.DataFrame({'code':[item],
								'date':[str(i)+'-'+str(j+1)],
								'price':[price]
								})
			df=df.append(df_n)
	print("已完成%s" %item)


df.to_excel('E:\\blog数据\\stock_price.xlsx',encoding='utf-8')
# yconnect = create_engine('mysql://root:232738@localhost:3306/mydb?charset=utf8')
# df.to_sql(df,'stock_price', yconnect, schema='mydb', if_exists='append')